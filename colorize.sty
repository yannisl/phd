%%
%% This is file `colorize.sty',
%% generated with the docstrip utility.
%%
%% The original source files were:
%%
%% phd-documentation.dtx  (with options: `colorize')
%% ----------------------------------------------------------------
%% phd --- A package to beautify documents.
%% E-mail: yannislaz@gmail.com
%% Released under the LaTeX Project Public License v1.3c or later
%% See http://www.latex-project.org/lppl.txt
%% ----------------------------------------------------------------
\ExplSyntaxOn
\bgroup
\obeylines
\tl_new:N \l__phdd_store_tl
\egroup

\NewDocumentCommand{\codelinefont}{O{blue} m}
  {\begingroup\bfseries
    \color{#1}
    #2
   \endgroup
  }

\def\keyvaluestyle#1
  {
    \begingroup
      =\color{orange}
      %\panunicode #1,
    \endgroup
  }

\regex_const:Nn \c_ifs_regex { ((\\if(x{1}|num|dimen|cat|eof|false|true|mode|mmode|hmode
         |vmode|\_meaning|_mode_|inner|defined|csname|[@a-zA-Z]*)*|\\else)|(\\fi))  }
  \cs_set:Npn \colorizeifs {
   \regex_replace_all:NnN
     {\c_ifs_regex}
     {
       \c{codelinefont}[purple500]\cB\{\1\cE\}
     }\l__phdd_store_tl
}
  % Coffin l33 module. box vbox hbox use same colors
\clist_gset:Nn\coffinkeywords_clist
  { {(\\(coffin|box|hbox|vbox)_*[a-zA-Z_]+[^:])},
  }
\def\coffinkeywordsregex#1{
   \regex_replace_all:nnN
     {#1}
     {
       \c{codelinefont}[oprah]\cB\{\1\cE\}
     }\l__phdd_store_tl
}

\regex_const:Nn \c_handlers_regex { ( ( [.]code|\.value|\.bool|.meta|.choice|\.tl )[a-z\_]*[\:] )  }
  \cs_set:Npn \colorizehandlers {
   \regex_replace_all:NnN
     {\c_handlers_regex}
     {
       \c{codelinefont}[thered]\cB\{\1\cE\}
     }\l__phdd_store_tl
}

\cs_generate_variant:Nn \clist_map_function:NN {cc}
\cs_generate_variant:Nn \regex_replace_all:NnN {cnN}
\clist_new:N \l__phdd_regexes_clist
\cs_set:Npn \phd_more_keywords_tl {|phd}

\def\AAA#1{
 %  \regex_const:Nn \c_cs_regex
   \__regex_compile:n{(\\(cs|regex|seq|tl|clist|dim|char|int|%
group|bool|prg|iow|prop|exp|msg|quark|str|token|keys|q|c|%
coffin|box|hbox|vbox|tex|sys#1)_[a-zA-Z_]+[^:])}
  \tl_set:Nx \c_cs_regex { \exp_not:o \l__regex_internal_regex }
}
\cs_new:Npn \add_module_prefix:n #1 {
  \tl_put_right:Nn\phd_more_keywords_tl{#1}
  \expandafter\AAA\expandafter{\phd_more_keywords_tl }

}
\cs_generate_variant:Nn \add_module_prefix:n {x,f}
\NewDocumentCommand\AddPrefix{m}
  {
    \add_module_prefix:n {#1}
  }

\add_module_prefix:x {|phdd}

\tl_new:N \g__phdd_design_colors_tl
\tl_put_right:Nn \g__phdd_design_colors_tl
  {
    \cs_set:Npn \cscolor{\color{blue}}
    \cs_set:Npn \regexcolor{\color{theblue}}
    \cs_set:Npn \seqcolor{\color{purple500}}
    \cs_set:Npn \tlcolor{\color{blue900}}
    \cs_set:Npn \clistcolor{\color{purple800}}
    \cs_set:Npn \dimcolor{\color{unorange}}
    \cs_set:Npn \charcolor{\color{red}}
    \cs_set:Npn \intcolor{\color{red}}
    \cs_set:Npn \groupcolor{\color{red800}}
    \cs_set:Npn \boolcolor{\color{purple800}}
    \cs_set:Npn \prgcolor{\color{purple800}}
    \cs_set:Npn \iowcolor{\color{purple500}}
    \cs_set:Npn \propcolor{\color{red400}}
    \cs_set:Npn \expcolor{\color{redA100}}
    \cs_set:Npn \msgcolor{\color{green900}}
    \cs_set:Npn \quarkcolor{\color{red800}}
    \cs_set:Npn \strcolor{\color{orange700}}
    \cs_set:Npn \tokencolor{\color{orange700}}
    \cs_set:Npn \qcolor{\color{orange500}}
    \cs_set:Npn \ccolor{\color{unorange}}
    \cs_set:Npn \keyscolor{\color{deeporange700}}
    \cs_set:Npn \coffincolor{\color{deeporange700}}
    \cs_set:Npn \boxcolor{\color{deeporange600}}
    \cs_set:Npn \hboxcolor{\color{deeporange500}}
    \cs_set:Npn \vboxcolor{\color{deeporange500}}
    \cs_set:Npn \phdcolor{\color{deeporange900}}
    \cs_set:Npn \phddcolor{\color{deeporange900}}
    \cs_set:Npn \texcolor{\color{red800}}
    \cs_set:Npn \cctabcolor{\color{red800}}
    \cs_set:Npn \intarraycolor{\color{green500}}
    \cs_set:Npn \syscolor{\color{purple500}}
  }

\tl_use:N \g__phdd_design_colors_tl

\regex_const:Nn \c_tl_regex {((\\tl_[a-zA-Z_]+[^:])|(\\c_[^_][a-z\_]+tl)) }
\regex_const:Nn \c_seq_regex {((\\seq_[a-zA-Z_]+[^:])|(\\c_[^_][a-z\_]+seq)) }
\regex_const:Nn \c_clist_regex { ((\\clist_[a-zA-Z_]+[^:])|(\\c_[^_][a-z\_]+clist)) }
\regex_const:Nn \c_tex_regex { (\\tex_[a-zA-Z_]+[^:]) }
\regex_const:Nn \c_exp_regex { (\\exp_[a-zA-Z_]+[^:]) }
\regex_const:Nn \c_dim_regex { ((\\bool_[a-zA-Z_]+[^:])|(\\c_[^_][a-z\_]+dim)) }
\regex_const:Nn \c_str_regex { ((\\str_[a-zA-Z_]+[^:])|(\\c_[^_][a-z\_]+str)) }
\regex_const:Nn \c_bool_regex { ((\\bool_[a-zA-Z_]+[^:])|(\\c_[^_][a-z\_]+bool)) }
\regex_const:Nn \c_char_regex { ((\\char_[a-zA-Z_]+[^:])|(\\c_[^_][a-z\_]+char)) }
\regex_const:Nn \c_int_regex { ((\\int_[a-zA-Z_]+[^:])|(\\c_[^_][a-z\_]+int)) }
\regex_const:Nn \c_iow_regex { (\\iow_[a-zA-Z_]+[^:]) }
\regex_const:Nn \c_group_regex { (\\group_[a-zA-Z_]+[^:]) }
\regex_const:Nn \c_box_regex { (\\box_[a-zA-Z_]+[^:]) }
\regex_const:Nn \c_skip_regex { ((\\skip_[a-zA-Z_]+[^:])|(\\c_[^_][a-z\_]+skip)) }
\regex_const:Nn \c_token_regex { ((\\token_[a-zA-Z_]+[^:])|(\\c_[^_][a-z\_]+token)) }
\regex_const:Nn \c_regex_regex { ((\\regex_[a-zA-Z_]+[^:])|(\\c_[^_][a-z\_]+regex)) }

\cs_new:Npn \colorizemodulekeywords #1 #2
  {
    \cs_set:cpn {currentcolors} {\color{#2}}

    \cs_gset:cpn {#1keywordsregex} ##1
      {
     \regex_replace_all:nnN
      { ##1}
      {
        \c{codelinefont}[#2]\cB\{\0\cE\}
      }\l__phdd_store_tl
      }

      \cs_gset:Npn \keywordsregex_aux:n ##1 ##2
      {
     \regex_replace_all:cnN
        {c_cs_regex}
      {
        \cB{
           \c{\2color}\1
        \cE}
      }\l__phdd_store_tl
      }
    \cs_if_free:cTF {c_cs_regex} {
    }
    { \keywordsregex_aux:n {#1} {#2}  }

  }
\regex_const:Nn \c_braces_regex { (\{|\})+ }
\regex_const:Nn \c_square_brackets_regex { [\[\]]+ }
\regex_const:Nn \c_brackets_regex { [\(\)] }

\def\bracescolor#1{\normalcolor\textcolor{thebracescolor}{#1}\normalcolor}

\def\squarebracketscolor#1{\textcolor{thesquarebracketscolor}{#1}}

\def\bracketscolor#1{\bgroup\bfseries\color{thered}#1\egroup}
\cs_set:Npn \colorizebraces #1
  {   
  \regex_replace_all:NnN
    {
      \c_braces_regex
    }
    {
      \c{bracescolor}\cB\{\0\cE\}
    }\l__phdd_store_tl
  }

\cs_set:Npn \colorizesquarebrackets #1
  {   
  \regex_replace_all:NnN
    {
      \c_square_brackets_regex
    }
    {
      \c{squarebracketscolor}\cB\{\0\cE\}
    }\l__phdd_store_tl
  }
\cs_set:Npn \colorizebrackets #1
  {   
  \regex_replace_all:NnN
    {
      \c_brackets_regex
    }
    {
      \c{bracketscolor}\0
    }\l__phdd_store_tl
  }

\regex_const:Nn \c_math_operator_regex { [\$]+ }

\def\mathoperatorcolor#1
{
  \bgroup
    \bfseries\color{thered}#1
  \egroup
}

\cs_set:Npn \colorizemathoperator #1
  {
  \regex_replace_all:NnN
    {
      \c_math_operator_regex
    }
    {
      \c{mathoperatorcolor}\cB\{\0 \cE\}
    }\l__phdd_store_tl 
  }
\cs_new:Npn \colorizexparsedeclarations{
 \regex_replace_all:nnN
     {
       \\(DeclareDocumentCommand|DeclareOption|NewDocumentCommand%
         |DeclareRobustCommand|NewDocumentEnvironment|r*e*newcommand|newenvironment|def)[\*\{\\\_]
     }
     {
        \c{codelinefont}[blue]\cB\{\1\cE\}
     }\l__phdd_store_tl
} 
%%
\regex_const:Nn \c_comments_regex
  {
    (\%\ *\%*[ a-zA-Z\ \\\*\_\:\;\.\!\"\`\'\#\&\-\^\(\)\|\d\=\+\,\@\}\{\[\]\/\% ]*)
  }

\cs_gset:Npn \colorizecomments
  {
      \regex_replace_all:NnN \c_comments_regex
     {
          \c{color}\cB{green800\cE}\1\c{normalcolor}
        }\l__phdd_store_tl
  }


\cs_gset:Npn \listings_code
  {
  %\colorizebraces{orangeA700}
  %\colorizebrackets{thered}
%%
  \colorizemodulekeywords{cs}{-thecsmodulecolor}
  %\colorizecomments
  %\commentshack
 % \show\l__phdd_store_tl

  }
\ExplSyntaxOff
\endinput
%%
%% End of file `colorize.sty'.
